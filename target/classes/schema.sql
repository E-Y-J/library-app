CREATE SEQUENCE book_sequence START WITH 1 INCREMENT BY 1 AS BIGINT;
CREATE SEQUENCE book_copy_sequence START WITH 1 INCREMENT BY 1 AS BIGINT;
CREATE SEQUENCE book_loan_sequence START WITH 1 INCREMENT BY 1 AS BIGINT;
CREATE SEQUENCE loan_period_sequence START WITH 1 INCREMENT BY 1 AS BIGINT;
CREATE SEQUENCE member_sequence START WITH 1 INCREMENT BY 1 AS BIGINT;
CREATE SEQUENCE member_category_sequence START WITH 1 INCREMENT BY 1 AS BIGINT;

CREATE TABLE book (
	id BIGINT GENERATED BY DEFAULT AS SEQUENCE book_sequence,
	title VARCHAR(255) NOT NULL,
	author VARCHAR(255) NOT NULL,
	date_published DATE NOT NULL,
	category VARCHAR(255) NOT NULL,
	isbn10 VARCHAR(255) NOT NULL,
	isbn13 VARCHAR(255) NOT NULL,
	CONSTRAINT pk_book_id PRIMARY KEY (id)
);

CREATE TABLE book_copy (
	id BIGINT GENERATED BY DEFAULT AS SEQUENCE book_copy_sequence,
	book_id BIGINT NOT NULL,
	barcode varchar(255) NOT NULL,
	CONSTRAINT pk_book_copy_id PRIMARY KEY (id),
	CONSTRAINT fk_book_id FOREIGN KEY (book_id) REFERENCES book,
	CONSTRAINT uq_book_copy_barcode UNIQUE (barcode)
);

CREATE TABLE member_category (
	id BIGINT GENERATED BY DEFAULT AS SEQUENCE member_category_sequence,
	category VARCHAR(255) NOT NULL,
	number_of_books INTEGER NOT NULL,
	CONSTRAINT pk_member_category_id PRIMARY KEY (id),
);

CREATE TABLE member_account (
	id BIGINT GENERATED BY DEFAULT AS SEQUENCE member_sequence,
	member_id VARCHAR(255) NOT NULL,
	name VARCHAR(255) NOT NULL,
	category_id BIGINT NOT NULL,
	CONSTRAINT pk_member_account_id PRIMARY KEY (id),
	CONSTRAINT fk_member_account_member_category_id FOREIGN KEY (category_id) REFERENCES member_category,
);

CREATE TABLE book_loan (
	id BIGINT GENERATED BY DEFAULT AS SEQUENCE book_loan_sequence,
	member_id BIGINT NOT NULL,
	book_copy_id BIGINT NOT NULL,
	borrow_date DATE NOT NULL,
	due_date DATE NOT NULL,
	CONSTRAINT pk_book_loan_id PRIMARY KEY (id),
	CONSTRAINT fk_member_id FOREIGN KEY (member_id) REFERENCES member_account,
	CONSTRAINT fk_book_copy_id FOREIGN KEY (book_copy_id) REFERENCES book_copy,
);

CREATE TABLE loan_period (
	id BIGINT GENERATED BY DEFAULT AS SEQUENCE loan_period_sequence,
	member_category_id BIGINT NOT NULL,
	book_category VARCHAR(255) NOT NULL,
	number_of_days INTEGER NOT NULL,
	CONSTRAINT pk_loan_period_id PRIMARY KEY (id),
	CONSTRAINT fk_loan_period_member_category_id FOREIGN KEY (member_category_id) REFERENCES member_category,

);
